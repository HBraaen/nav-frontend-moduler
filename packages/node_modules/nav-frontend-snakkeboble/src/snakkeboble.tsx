import * as React from 'react';
import * as classNames from 'classnames';
import { PropTypes as PT } from 'prop-types';
import 'nav-frontend-snakkeboble-style'; // eslint-disable-line import/extensions
import { Panel } from 'nav-frontend-paneler';
import { Undertekst } from 'nav-frontend-typografi';

const snakkebobleCls = (hoyre) => classNames('snakkeboble', {
    'snakkeboble--hoyre': hoyre, 'snakkeboble--venstre': !hoyre
});

const getToppComponent = (tekst) => {
    if (tekst) return (<Undertekst className="snakkeboble-panel__topp blokk-xs">{tekst}</Undertekst>);
}

export interface SnakkebobleProps {
    dato?: string;
    topp?: string;
    children: React.ReactChildren | React.ReactChild | React.ReactNode;
    pilHoyre?: boolean;
    ikonClass?: string;
}

/**
 * En snakkeboble for dialog
 */
class Snakkeboble extends React.Component<SnakkebobleProps> { // eslint-disable-line react/prefer-stateless-function
    render() {
        const { dato, topp, children, pilHoyre, ikonClass } = this.props;
        const toppTekst = topp || dato;
        const toppComponent = getToppComponent(toppTekst);

        return (
            <div className={snakkebobleCls(pilHoyre)}>
                <i className={ikonClass} />
                <div className="snakkeboble__snakkeboble-pil-container">
                    <i className="snakkeboble__snakkebole-pil" />
                </div>
                <Panel className="snakkeboble-panel">
                    {toppComponent}
                    <div className="snakkeboble-panel__tekst">{children}</div>
                </Panel>
            </div>
        );
    }
}

(Snakkeboble as React.ComponentClass).defaultProps = {
    /**
     * Default er at pilen peker mot venstre
     */
    pilHoyre: false,
    /**
     * Gir enkel default styling på ikoner
     */
    ikonClass: 'snakkeboble__ikon'
};

(Snakkeboble as React.ComponentClass).propTypes = {
    /**
     * Toppteksten (tittel) for meldingen
     */
    topp: PT.string,
    /**
     * @Deprecated Dato for melding, bruk `topp`
     */
    dato: PT.string,
    /**
     * Tekst for melding
     */
    children: PT.node.isRequired,
    /**
     * Settes denne peker pilen til snakkeboblen mot høyre, og snakkeboblen og teksten i snakkeboblen flyter mot høyre.
     */
    pilHoyre: PT.bool,
    /**
     * Klasse som brukes på ikonet. Dette lar deg styre form, farge og illustrasjon.
     */
    ikonClass: PT.string
};

export default Snakkeboble;
